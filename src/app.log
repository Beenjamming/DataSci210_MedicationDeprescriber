2024-11-22 15:11:00,227 - FileLogger - INFO - Start loop 1...
2024-11-22 15:11:00,227 - FileLogger - INFO - rec: continue, diagnosis: ['Barretts Esophagus', 'Chronic NSAID used with bleeding risk', 'Severe esophagitis', 'Documented history of bleeding GUI ulcer']
2024-11-22 15:11:00,987 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2024-11-22 15:11:00,997 - FileLogger - INFO - diagnosis_source_bool: False
2024-11-22 15:11:00,997 - FileLogger - INFO - diagnosis_dict: {'diagnosis_boolean': '0', 'explanation': "There is no evidence of Barrett's Esophagus, Chronic NSAID use with bleeding risk, Severe esophagitis, or Documented history of bleeding GI ulcer in the provided information. The patient has a diagnosis of GIB (gastrointestinal bleeding) which may be the reason for the PPI prescription, but it is not explicitly listed in the conditions to check for."}
2024-11-22 15:11:00,997 - FileLogger - INFO - diagnosis_token_count: 573
2024-11-22 15:11:01,697 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2024-11-22 15:11:01,698 - FileLogger - INFO - encounters_source_bool: False
2024-11-22 15:11:01,698 - FileLogger - INFO - encounters_dict: {'diagnosis_boolean': '0', 'explanation': "Based on the provided information, there is no clear evidence of Barrett's Esophagus, Chronic NSAID use with bleeding risk, Severe esophagitis, or Documented history of bleeding GI ulcer. The primary diagnosis is listed as 'Gastrointestinal hemorrhage, unspecified', which does not provide enough information to confirm any of the specified conditions. Therefore, it is not possible to determine the reason for the PPI prescription with certainty."}
2024-11-22 15:11:01,698 - FileLogger - INFO - encounters_token_count: 694
2024-11-22 15:11:01,698 - FileLogger - INFO - rec: stop, diagnosis: ['Peptic Ulcer Disease', 'Chronic NSAID use with bleeding risk', 'ICU Stress Ulcer Prophylaxis', 'H Pylori infection']
2024-11-22 15:11:02,391 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2024-11-22 15:11:02,392 - FileLogger - INFO - diagnosis_source_bool: False
2024-11-22 15:11:02,392 - FileLogger - INFO - diagnosis_dict: {'diagnosis_boolean': '0', 'explanation': "There is no direct evidence of Peptic Ulcer Disease, Chronic NSAID use with bleeding risk, H Pylori infection, or ICU Stress Ulcer Prophylaxis in the provided information. The patient has a diagnosis of Gastrointestinal Bleeding (GIB) on admission, but the underlying cause is not specified. The hospital-acquired diagnosis is listed as 'Unspecified'. Therefore, we cannot confirm any of the conditions that would typically warrant PPI use."}
2024-11-22 15:11:02,392 - FileLogger - INFO - diagnosis_token_count: 589
2024-11-22 15:11:03,151 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2024-11-22 15:11:03,160 - FileLogger - INFO - encounters_source_bool: False
2024-11-22 15:11:03,160 - FileLogger - INFO - encounters_dict: {'diagnosis_boolean': '0', 'explanation': 'There is no direct evidence of Peptic Ulcer Disease, Chronic NSAID use with bleeding risk, ICU Stress Ulcer Prophylaxis, or H Pylori infection in the provided information. The primary diagnosis is Gastrointestinal hemorrhage, unspecified, but the underlying cause is not specified.'}
2024-11-22 15:11:03,160 - FileLogger - INFO - encounters_token_count: 717
2024-11-22 15:11:03,160 - FileLogger - INFO - rec: deprescribe, diagnosis: ['Mild to moderate esophagitis', 'GERD']
2024-11-22 15:11:03,758 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2024-11-22 15:11:03,759 - FileLogger - INFO - diagnosis_source_bool: False
2024-11-22 15:11:03,759 - FileLogger - INFO - diagnosis_dict: {'diagnosis_boolean': '0', 'explanation': "There is no direct evidence of 'Mild to moderate esophagitis' or 'GERD' in the provided information. The patient has a diagnosis of 'GIB (gastrointestinal bleeding)' which may be related to various conditions, but it does not specifically confirm 'Mild to moderate esophagitis' or 'GERD'."}
2024-11-22 15:11:03,759 - FileLogger - INFO - diagnosis_token_count: 546
2024-11-22 15:11:04,395 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2024-11-22 15:11:04,397 - FileLogger - INFO - encounters_source_bool: False
2024-11-22 15:11:04,397 - FileLogger - INFO - encounters_dict: {'diagnosis_boolean': '0', 'explanation': "There is no direct evidence of 'Mild to moderate esophagitis' or 'GERD' in the provided information. The primary diagnosis is 'Gastrointestinal hemorrhage, unspecified', which may be related to various conditions, but it does not specifically indicate esophagitis or GERD. Therefore, it is not possible to confirm these conditions based on the given data."}
2024-11-22 15:11:04,397 - FileLogger - INFO - encounters_token_count: 661
2024-11-22 15:11:04,397 - FileLogger - INFO - loop 2
2024-11-22 15:11:04,397 - FileLogger - INFO - rec: continue, diagnosis: ['Barretts Esophagus', 'Chronic NSAID used with bleeding risk', 'Severe esophagitis', 'Documented history of bleeding GUI ulcer']
2024-11-22 15:11:19,841 - faiss.loader - INFO - Loading faiss with AVX2 support.
2024-11-22 15:11:19,863 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2024-11-22 15:11:20,075 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2024-11-22 15:11:20,075 - groq._base_client - INFO - Retrying request to /openai/v1/chat/completions in 5.000000 seconds
2024-11-22 15:11:26,469 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2024-11-22 15:11:26,470 - FileLogger - INFO - notes_source_bool: False
2024-11-22 15:11:26,470 - FileLogger - INFO - notes_dict: {'diagnosis_boolean': '0', 'explanation': "There is no evidence of Barrett's Esophagus, Chronic NSAID use with bleeding risk, Severe esophagitis, or Documented history of bleeding GI ulcer in the provided context. The patient's EGD and colonoscopy results show mild antral erythema and a punctate area of submucosal erythema in the gastric body, but no active bleeding or severe esophagitis. The patient's history of AVMs and gastritis is noted, but there is no indication of NSAID use or Barrett's Esophagus."}
2024-11-22 15:11:26,470 - FileLogger - INFO - notes_token_count: 3560
2024-11-22 15:11:26,470 - FileLogger - INFO - rec: stop, diagnosis: ['Peptic Ulcer Disease', 'Chronic NSAID use with bleeding risk', 'ICU Stress Ulcer Prophylaxis', 'H Pylori infection']
2024-11-22 15:11:41,776 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2024-11-22 15:11:41,776 - groq._base_client - INFO - Retrying request to /openai/v1/chat/completions in 19.000000 seconds
2024-11-22 15:12:02,162 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2024-11-22 15:12:02,163 - FileLogger - INFO - notes_source_bool: False
2024-11-22 15:12:02,164 - FileLogger - INFO - notes_dict: {'diagnosis_boolean': '0', 'explanation': "There is no clear evidence of Peptic Ulcer Disease, Chronic NSAID use with bleeding risk, ICU Stress Ulcer Prophylaxis, or H Pylori infection in the provided context. The patient has a history of mild gastritis and small AVMs, but the recent EGD and colonoscopy results do not indicate active bleeding or ulcers. The patient's Helicobacter pylori IgG Antibody and Antigen tests are pending, but there is no mention of NSAID use or ICU stay. Therefore, the diagnosis cannot be confirmed based on the provided information."}
2024-11-22 15:12:02,164 - FileLogger - INFO - notes_token_count: 3562
2024-11-22 15:12:02,164 - FileLogger - INFO - rec: deprescribe, diagnosis: ['Mild to moderate esophagitis', 'GERD']
2024-11-22 15:12:17,391 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2024-11-22 15:12:17,391 - groq._base_client - INFO - Retrying request to /openai/v1/chat/completions in 22.000000 seconds
2024-11-22 15:12:40,632 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2024-11-22 15:12:40,633 - FileLogger - INFO - notes_source_bool: False
2024-11-22 15:12:40,633 - FileLogger - INFO - notes_dict: {'diagnosis_boolean': '0', 'explanation': 'There is no evidence of esophagitis or GERD in the provided context. The esophagus was reported as normal in the EGD and colonoscopy procedures, with no ulcers, erosions, strictures, masses, or varices seen.'}
2024-11-22 15:12:40,633 - FileLogger - INFO - notes_token_count: 3968
2024-11-22 15:12:40,729 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2024-11-22 15:12:40,729 - groq._base_client - INFO - Retrying request to /openai/v1/chat/completions in 12.000000 seconds
2024-11-22 15:12:53,344 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2024-11-22 15:12:53,345 - FileLogger - INFO - 

 final_recommendation: deprescribe
2024-11-22 15:12:53,345 - FileLogger - INFO - final_reasoning: The recommendation is to deprescribe the medication due to a lack of evidence supporting the presence of conditions that typically warrant its use, such as esophagitis or GERD, as the patient's EGD and colonoscopy results showed a normal esophagus with no ulcers, erosions, or other abnormalities.
2024-11-22 15:12:53,345 - FileLogger - INFO - token_usage: 15995
2024-11-22 15:12:53,346 - FileLogger - INFO - search_history_so_far: {'diagnosis_source_continue': {'diagnosis_boolean': '0', 'explanation': "There is no evidence of Barrett's Esophagus, Chronic NSAID use with bleeding risk, Severe esophagitis, or Documented history of bleeding GI ulcer in the provided information. The patient has a diagnosis of GIB (gastrointestinal bleeding) which may be the reason for the PPI prescription, but it is not explicitly listed in the conditions to check for."}, 'encounters_source_continue': {'diagnosis_boolean': '0', 'explanation': "Based on the provided information, there is no clear evidence of Barrett's Esophagus, Chronic NSAID use with bleeding risk, Severe esophagitis, or Documented history of bleeding GI ulcer. The primary diagnosis is listed as 'Gastrointestinal hemorrhage, unspecified', which does not provide enough information to confirm any of the specified conditions. Therefore, it is not possible to determine the reason for the PPI prescription with certainty."}, 'diagnosis_source_stop': {'diagnosis_boolean': '0', 'explanation': "There is no direct evidence of Peptic Ulcer Disease, Chronic NSAID use with bleeding risk, H Pylori infection, or ICU Stress Ulcer Prophylaxis in the provided information. The patient has a diagnosis of Gastrointestinal Bleeding (GIB) on admission, but the underlying cause is not specified. The hospital-acquired diagnosis is listed as 'Unspecified'. Therefore, we cannot confirm any of the conditions that would typically warrant PPI use."}, 'encounters_source_stop': {'diagnosis_boolean': '0', 'explanation': 'There is no direct evidence of Peptic Ulcer Disease, Chronic NSAID use with bleeding risk, ICU Stress Ulcer Prophylaxis, or H Pylori infection in the provided information. The primary diagnosis is Gastrointestinal hemorrhage, unspecified, but the underlying cause is not specified.'}, 'diagnosis_source_deprescribe': {'diagnosis_boolean': '0', 'explanation': "There is no direct evidence of 'Mild to moderate esophagitis' or 'GERD' in the provided information. The patient has a diagnosis of 'GIB (gastrointestinal bleeding)' which may be related to various conditions, but it does not specifically confirm 'Mild to moderate esophagitis' or 'GERD'."}, 'encounters_source_deprescribe': {'diagnosis_boolean': '0', 'explanation': "There is no direct evidence of 'Mild to moderate esophagitis' or 'GERD' in the provided information. The primary diagnosis is 'Gastrointestinal hemorrhage, unspecified', which may be related to various conditions, but it does not specifically indicate esophagitis or GERD. Therefore, it is not possible to confirm these conditions based on the given data."}, 'notes_source_continue': {'diagnosis_boolean': '0', 'explanation': "There is no evidence of Barrett's Esophagus, Chronic NSAID use with bleeding risk, Severe esophagitis, or Documented history of bleeding GI ulcer in the provided context. The patient's EGD and colonoscopy results show mild antral erythema and a punctate area of submucosal erythema in the gastric body, but no active bleeding or severe esophagitis. The patient's history of AVMs and gastritis is noted, but there is no indication of NSAID use or Barrett's Esophagus."}, 'notes_source_stop': {'diagnosis_boolean': '0', 'explanation': "There is no clear evidence of Peptic Ulcer Disease, Chronic NSAID use with bleeding risk, ICU Stress Ulcer Prophylaxis, or H Pylori infection in the provided context. The patient has a history of mild gastritis and small AVMs, but the recent EGD and colonoscopy results do not indicate active bleeding or ulcers. The patient's Helicobacter pylori IgG Antibody and Antigen tests are pending, but there is no mention of NSAID use or ICU stay. Therefore, the diagnosis cannot be confirmed based on the provided information."}, 'notes_source_deprescribe': {'diagnosis_boolean': '0', 'explanation': 'There is no evidence of esophagitis or GERD in the provided context. The esophagus was reported as normal in the EGD and colonoscopy procedures, with no ulcers, erosions, strictures, masses, or varices seen.'}}
2024-11-22 15:12:53,346 - FileLogger - INFO - token_count_history: {'diagnosis_source_continue': 573, 'encounters_source_continue': 694, 'diagnosis_source_stop': 589, 'encounters_source_stop': 717, 'diagnosis_source_deprescribe': 546, 'encounters_source_deprescribe': 661, 'notes_source_continue': 3560, 'notes_source_stop': 3562, 'notes_source_deprescribe': 3968, 'final_summary': 1125}
